<!DOCTYPE html><html lang="zh-CN"><head><title>贺刘芳的笔记本</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><link rel="stylesheet" href="../../layui/css/layui.css"><link rel="stylesheet" href="../../css/common.css"><link rel="stylesheet" href="../../css/post.css"><link rel="stylesheet" href="../../lib/prism/prism.css"><link rel="shortcut icon" href="../../img/favicon.ico"><link rel="stylesheet" href="../../lib/iconfont/iconfont.css"><meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="atom.xml" title="贺刘芳的搬砖日记" type="application/atom+xml"></head><body style="overflow:hidden" data-prismjs-copy="复制" data-prismjs-copy-success="复制成功!"><div class="qy-nav"><ul class="layui-nav" lay-filter="" lay-bar="disabled" lay-unselect><li class="hide-xs layui-nav-item" id="searchBtn" style="float:right"><a class="searchBtn" href="javascript:void(0);"><i class="layui-icon layui-icon-search"></i> 搜索</a></li><li class="hide-xs layui-nav-item" style="float:right"><a target="_blank" rel="noopener" href="https://github.com/heliufang"><i class="icon iconfont icon-github"></i> github</a></li><li class="hide-xs layui-nav-item" style="float:right"><a target="_blank" rel="noopener" href="https://gitee.com/heliufang"><i class="icon iconfont icon-gitee"></i> gitee</a></li><li class="hide-xs layui-nav-item" style="float:right"><a target="_blank" rel="noopener" href="https://www.cnblogs.com/helf"><i class="icon iconfont icon-cnblogs"></i> 博客园</a></li><li class="layui-nav-item"><a class="title" href="/" style="padding:0"><i class="layui-anim layui-anim-rotate layui-anim-loop layui-icon layui-icon-star-fill"></i> 贺刘芳的笔记本</a></li><li class="hide-xs layui-nav-item" style="float:right"><a href="/about"><i class="layui-icon layui-icon-friends"></i> 关于</a></li><li class="hide-xs layui-nav-item" style="float:right"><a href="/archives"><i class="layui-icon layui-icon-date"></i> 归档</a></li><li class="hide-xs layui-nav-item" style="float:right"><a href="/tags"><i class="layui-icon layui-icon-note"></i> 标签</a></li><li class="hide-xs layui-nav-item" style="float:right"><a href="/categories"><i class="layui-icon layui-icon-template-1"></i> 分类</a></li><li class="hide-xs layui-nav-item" style="float:right"><a href="/"><i class="layui-icon layui-icon-home"></i> 首页</a></li><li class="layui-nav-item hide-sm hide-md hide-lg" style="float:right"><a href="javascript:;">菜单</a><dl class="layui-nav-child"><dd><a href="/">首页</a></dd><dd><a href="/archives">归档</a></dd><dd><a href="/tags">标签</a></dd><dd><a href="/categories">分类</a></dd><dd><a href="/about">关于</a></dd><dd><a target="_blank" rel="noopener" href="https://github.com/heliufang" title="github">github</a></dd><dd><a target="_blank" rel="noopener" href="https://gitee.com/heliufang" title="gitee">gitee</a></dd><dd><a target="_blank" rel="noopener" href="https://www.cnblogs.com/helf" title="博客园">博客园</a></dd><dd><a href="javascript:void(0)" onclick='document.querySelector("#searchShade").style.display="block"'>搜索</a></dd></dl></li></ul><div id="loadingBox" class="loadingBox"><img src="/img/loading.gif"></div></div><div id="searchShade" class="searchShade"><div id="searchLayer"><div id="closeBtn" class="close"><i class="layui-icon layui-icon-close"></i></div><input id="searchTxt" type="text" placeholder="搜索文章(只支持文章标题关键字)" autofocus><div id="searchResult"></div></div></div><div class="layui-container center" id="top"><div class="layui-row layui-col-space20"><div class="layui-col-md3 hide-xs hide-sm"><div class="layui-card"><div class="layui-card-header"><i style="font-weight:700" class="layui-icon layui-icon-speaker"></i> 公告</div><div class="layui-card-body"><div class="userinfo"><img src="/head.png"><div class="name">淡泊明志，宁静致远</div><div class="icons"><a target="_blank" rel="noopener" href="https://github.com/heliufang" title="github"><i class="icon iconfont icon-github"></i></a> <a target="_blank" rel="noopener" href="https://gitee.com/heliufang" title="gitee"><i class="icon iconfont icon-gitee"></i></a> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/helf" title="博客园"><i class="icon iconfont icon-cnblogs"></i></a></div><div class="other"><div class="item"><a class="title" style="color:#ff5722" href="/"><p class="num">40</p><div>文章</div></a></div><div class="item"><a style="color:#009688" href="/categories"><div class="num">7</div><div class="title">分类</div></a></div><div class="item"><a class="title" style="color:#01aaed" href="/tags"><div class="num">44</div><div>标签</div></a></div></div></div></div></div><div class="layui-card ahover"><div class="layui-card-header"><i style="font-weight:700" class="layui-icon layui-icon-website"></i> 网站资讯</div><div class="layui-card-body"><div class="webInfo-item"><div class="title">已运行时间</div><div class="content"><span id="runDays" data-since-date="2020-12-24"><i class="layui-icon layui-icon-loading layui-anim layui-anim-rotate layui-anim-loop"></i></span>天</div></div><div class="webInfo-item"><div class="title">本站文章字数合计</div><div class="content">200.8k</div></div><div class="webInfo-item"><div class="title">最后更新时间</div><div class="content" id="lastUpdate" data-last-update="2023-01-13 23:27:32"><i class="layui-icon layui-icon-loading layui-anim layui-anim-rotate layui-anim-loop"></i></div></div></div></div><div class="layui-card ahover"><div class="layui-card-header"><i style="font-weight:700" class="layui-icon layui-icon-time"></i> 最新文章</div><div class="layui-card-body"><ul><li><a href="/posts/27fcdfc0/">1.react笔记</a></li><li><a href="/posts/304cd95d/">2.vue3.2新特性笔记</a></li><li><a href="/posts/f2f1536e/">3.node笔记</a></li><li><a href="/posts/73c9868e/">4.vue3笔记</a></li><li><a href="/posts/9d362be7/">5.TypeScript笔记</a></li></ul></div></div><div class="layui-card ahover"><div class="layui-card-header"><i style="font-weight:700" class="layui-icon layui-icon-template-1"></i> 文章分类</div><div class="layui-card-body left-a-color"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="../../categories/java/">java</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="../../categories/linux/">linux</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="../../categories/vue/">vue</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="../../categories/web%E5%89%8D%E7%AB%AF/">web前端</a><span class="category-list-count">17</span></li><li class="category-list-item"><a class="category-list-link" href="../../categories/%E5%85%AC%E4%BC%97%E5%8F%B7%E5%92%8C%E5%B0%8F%E7%A8%8B%E5%BA%8F/">公众号和小程序</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="../../categories/%E5%85%B6%E5%AE%83%E6%8A%80%E6%9C%AF/">其它技术</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="../../categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><span class="category-list-count">2</span></li></ul></div></div><div style="height:calc(100% - 60px - 60px);width:267px" id="toc-area" class="layui-card ahover"><div class="layui-card-header"><i class="layui-icon layui-icon-align-center"></i> 本文目录</div><div id="tocMain" class="layui-card-body" style="overflow:auto;height:calc(100% - 60px - 60px)"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81MongoDB%E7%AE%80%E4%BB%8B"><span class="toc-text">1、MongoDB简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AFMongoDB"><span class="toc-text">1.1、什么是MongoDB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2%E3%80%81MongoDB%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="toc-text">1.2、MongoDB体系结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3%E3%80%81%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text">1.3、数据类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-MongoDB-%E5%AE%89%E8%A3%85"><span class="toc-text">2.MongoDB 安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E3%80%81windows%E5%AE%89%E8%A3%85"><span class="toc-text">2.1 、windows安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2%E3%80%81linux%E5%AE%89%E8%A3%85"><span class="toc-text">2.2、linux安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3%E3%80%81docker%E5%AE%89%E8%A3%85"><span class="toc-text">2.3、docker安装</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-text">3、常用命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1%E3%80%81%E9%80%89%E6%8B%A9%E5%92%8C%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">3.1、选择和创建数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2%E3%80%81%E6%8F%92%E5%85%A5%E4%B8%8E%E6%9F%A5%E8%AF%A2%E6%96%87%E6%A1%A3"><span class="toc-text">3.2、插入与查询文档</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E6%96%87%E6%A1%A3"><span class="toc-text">插入文档</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%96%87%E6%A1%A3"><span class="toc-text">查询文档</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3%E3%80%81%E4%BF%AE%E6%94%B9%E5%92%8C%E5%88%A0%E9%99%A4%E6%96%87%E6%A1%A3"><span class="toc-text">3.3、修改和删除文档</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%96%87%E6%A1%A3"><span class="toc-text">修改文档</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%96%87%E6%A1%A3"><span class="toc-text">删除文档</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4%E3%80%81%E7%BB%9F%E8%AE%A1%E6%9D%A1%E6%95%B0"><span class="toc-text">3.4、统计条数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5%E3%80%81%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2"><span class="toc-text">3.5、模糊查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6%E3%80%81%E5%A4%A7%E4%BA%8E-%E5%B0%8F%E4%BA%8E-%E4%B8%8D%E7%AD%89%E4%BA%8E"><span class="toc-text">3.6、大于 小于 不等于</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-7%E3%80%81%E5%8C%85%E5%90%AB%E4%B8%8E%E4%B8%8D%E5%8C%85%E5%90%AB"><span class="toc-text">3.7、包含与不包含</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-8%E3%80%81%E6%9D%A1%E4%BB%B6%E8%BF%9E%E6%8E%A5"><span class="toc-text">3.8、条件连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-9%E3%80%81%E5%88%97%E5%80%BC%E5%A2%9E%E9%95%BF"><span class="toc-text">3.9、列值增长</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81java%E6%93%8D%E4%BD%9Cmongodb"><span class="toc-text">4、java操作mongodb</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1%E3%80%81mongodb-driver"><span class="toc-text">4.1、mongodb-driver</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-1%E3%80%81%E6%9F%A5%E8%AF%A2%E5%85%A8%E9%83%A8"><span class="toc-text">4.1.1、查询全部</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-2%E3%80%81%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-text">4.1.2、插入数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-3%E3%80%81%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2"><span class="toc-text">4.1.3、条件查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2%E3%80%81SpringDataMongoDB"><span class="toc-text">4.2、SpringDataMongoDB</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1%E3%80%81%E5%88%9B%E5%BB%BA%E5%B7%A5%E7%A8%8B"><span class="toc-text">4.2.1、创建工程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2%E3%80%81%E5%9F%BA%E6%9C%AC%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5API%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-text">4.2.2、基本增删改查API的实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-3%E3%80%81%E6%A0%B9%E6%8D%AE%E6%96%B9%E6%B3%95%E5%91%BD%E5%90%8D%E6%9F%A5%E8%AF%A2"><span class="toc-text">4.2.3、根据方法命名查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-4%E3%80%81%E4%BD%BF%E7%94%A8MongoTemplate"><span class="toc-text">4.2.4、使用MongoTemplate</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%96%87%E6%A1%A3"><span class="toc-text">相关文档</span></a></li></ol></li></ol></div><div class="readprocess"><div><i class="layui-icon layui-icon-read"></i> 已阅读：<span id="progressTxt"></span>%</div><div class="layui-progress" lay-filter="demo"><div class="layui-progress-bar" lay-percent="10%"></div></div></div></div></div><div class="layui-col-md9 markdown-body" style="background:#fff;margin-top:10px"><div class="article-title"><p><span><i class="layui-icon layui-icon-template-1"></i> 分类: <span class="layui-badge layui-bg-cyan">数据库</span> </span>| <span><i class="layui-icon layui-icon-note"></i> 标签: <span class="layui-badge layui-bg-black">MongoDB</span> <span class="layui-badge layui-bg-black">数据库</span></span></p><h1>MongoDB笔记</h1><p><span><i class="layui-icon layui-icon-survey"></i> 发表于: 2020-06-30 09:55:14 </span>| <span><i class="layui-icon layui-icon-app"></i> 字数统计: 3.4k </span>| <span><i class="layui-icon layui-icon-log"></i> 阅读时长预计: 16分钟</span></p></div><div id="article"><h2 id="1、MongoDB简介"><a href="#1、MongoDB简介" class="headerlink" title="1、MongoDB简介"></a>1、MongoDB简介</h2><h3 id="1-1、什么是MongoDB"><a href="#1-1、什么是MongoDB" class="headerlink" title="1.1、什么是MongoDB"></a>1.1、什么是MongoDB</h3><p>MongoDB 是一个跨平台的，面向文档的数据库，是当前 NoSQL 数据库产品中最热<br>门的一种。它介于关系数据库和非关系数据库之间，是非关系数据库当中功能最丰富，最<br>像关系数据库的产品。它支持的数据结构非常松散，是类似 JSON 的 BSON 格式，因此可以<br>存储比较复杂的数据类型。</p><p>对于数据量较大且价值较低的数据，可以使用mongodb减轻mysql的压力</p><p>MongoDB 的官方网站地址是：<a target="_blank" rel="noopener" href="http://www.mongodb.org/">http://www.mongodb.org/</a></p><p><img src="/posts/b3b38c86/1592807836805.png" alt="1592807836805"></p><h3 id="1-2、MongoDB体系结构"><a href="#1-2、MongoDB体系结构" class="headerlink" title="1.2、MongoDB体系结构"></a>1.2、MongoDB体系结构</h3><p>MongoDB 的逻辑结构是一种层次结构。主要由：<br><code>文档(document)</code>、<code>集合(collection)</code>、<code>数据库(database)</code>这三部分组成的。逻辑结构是面<br>向用户的，用户使用 MongoDB 开发应用程序使用的就是逻辑结构。<br>（1）MongoDB 的文档（document），相当于关系数据库中的一行记录。<br>（2）多个文档组成一个集合（collection），相当于关系数据库的表。<br>（3）多个集合（collection），逻辑上组织在一起，就是数据库（database）。<br>（4）一个 MongoDB 实例支持多个数据库（database）。<br>文档(document)、集合(collection)、数据库(database)的层次结构如下图:</p><p><img src="/posts/b3b38c86/1592807996776.png" alt="1592807996776"></p><p>下表是MongoDB与MySQL数据库逻辑结构概念的对比:</p><table><thead><tr><th>MongoDb 关系型</th><th>数据库Mysql</th></tr></thead><tbody><tr><td>数据库(databases)</td><td>数据库(databases)</td></tr><tr><td>集合(collections)</td><td>表(table)</td></tr><tr><td>文档(document)</td><td>行(row)</td></tr></tbody></table><h3 id="1-3、数据类型"><a href="#1-3、数据类型" class="headerlink" title="1.3、数据类型"></a>1.3、数据类型</h3><p>null：用于表示空值或者不存在的字段，{“x”:null}<br>布尔型：布尔类型有两个值true和false，{“x”:true}<br>数值：shell默认使用64位浮点型数值。{“x”：3.14}或{“x”：3}。对于整型值，可以使用<br>NumberInt（4字节符号整数）或NumberLong（8字节符号整数），<br>{“x”:NumberInt(“3”)}{“x”:NumberLong(“3”)}<br>字符串：UTF-8字符串都可以表示为字符串类型的数据，{“x”：“呵呵”}<br>日期：日期被存储为自新纪元依赖经过的毫秒数，不存储时区，{“x”:new Date()}</p><p>正则表达式：查询时，使用正则表达式作为限定条件，语法与JavaScript的正则表达式相<br>同，{“x”:&#x2F;[abc]&#x2F;}<br>数组：数据列表或数据集可以表示为数组，{“x”： [“a“，“b”,”c”]}<br>内嵌文档：文档可以嵌套其他文档，被嵌套的文档作为值来处理，{“x”:{“y”:3 }}<br>对象Id：对象id是一个12字节的字符串，是文档的唯一标识，{“x”: objectId() }<br>二进制数据：二进制数据是一个任意字节的字符串。它不能直接在shell中使用。如果要<br>将非utf-字符保存到数据库中，二进制数据是唯一的方式。<br>代码：查询和文档中可以包括任何JavaScript代码，{“x”:function(){&#x2F;…&#x2F;}}</p><h2 id="2-MongoDB-安装"><a href="#2-MongoDB-安装" class="headerlink" title="2.MongoDB 安装"></a>2.MongoDB 安装</h2><h3 id="2-1-、windows安装"><a href="#2-1-、windows安装" class="headerlink" title="2.1 、windows安装"></a>2.1 、windows安装</h3><ul><li>双击mongodb-win32-x86_64-2008plusssl-3.2.10-signed.msi 一直点下一步</li><li>安装完后建立MongoDB存数据的文件夹：C:\data\db</li><li>在MongoDB的安装目录下的bin目录下打开cmd窗口，输入一下命令启动窗口</li></ul><pre><code>mongod --dbpath c:\data\db
</code></pre><p>ps:为了启动方便也可以写一个startup.bat文件将上面的命令写入。</p><h3 id="2-2、linux安装"><a href="#2-2、linux安装" class="headerlink" title="2.2、linux安装"></a>2.2、linux安装</h3><h3 id="2-3、docker安装"><a href="#2-3、docker安装" class="headerlink" title="2.3、docker安装"></a>2.3、docker安装</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/helf/p/13188265.html">https://www.cnblogs.com/helf/p/13188265.html</a></p><h2 id="3、常用命令"><a href="#3、常用命令" class="headerlink" title="3、常用命令"></a>3、常用命令</h2><h3 id="3-1、选择和创建数据库"><a href="#3-1、选择和创建数据库" class="headerlink" title="3.1、选择和创建数据库"></a>3.1、选择和创建数据库</h3><p>语法格式：</p><pre><code>use 数据库名称
</code></pre><p>ps:如果数据库不存在则自动创建</p><p>以下为创建sys数据库</p><pre><code>use sys
</code></pre><h3 id="3-2、插入与查询文档"><a href="#3-2、插入与查询文档" class="headerlink" title="3.2、插入与查询文档"></a>3.2、插入与查询文档</h3><h4 id="插入文档"><a href="#插入文档" class="headerlink" title="插入文档"></a>插入文档</h4><pre><code>db.sysuser.insert(&#123;_id:&quot;1&quot;,name:&quot;张三&quot;,age:NumberInt(18)&#125;);
</code></pre><p>插入文档的语法格式：</p><pre><code>db.集合名称.insert(json数据);
</code></pre><p>例如：</p><pre><code> db.sysuser.insert(&#123;_id:&quot;1&quot;,name:&quot;张三&quot;,age:NumberInt(18)&#125;);
</code></pre><p>每条文档会有一个叫<code>_id</code>的字段，这个相当于关系数据库中表的主键，当插入文档记录时没有指定该字段MongoDB会自动创建，其类型是<code>ObjectID</code>类型。如果在插入文档记录时指定该字段也可以，其类型可以是ObjectID类型，也可以是MongoDB支持的任意类型。</p><h4 id="查询文档"><a href="#查询文档" class="headerlink" title="查询文档"></a>查询文档</h4><p>先插入一些数据</p><pre><code>db.sysuser.insert(&#123;_id:&quot;2&quot;,name:&quot;李四&quot;,age:NumberInt(21)&#125;);
db.sysuser.insert(&#123;_id:&quot;3&quot;,name:&quot;王五&quot;,age:NumberInt(28)&#125;);
db.sysuser.insert(&#123;_id:&quot;4&quot;,name:&quot;赵柳&quot;,age:NumberInt(22)&#125;);
db.sysuser.insert(&#123;_id:&quot;5&quot;,name:&quot;田七&quot;,age:NumberInt(23)&#125;);
</code></pre><ul><li>查询集合的所有数据</li></ul><p>语法：db.集合.find()</p><pre><code>db.sysuser.find()
</code></pre><ul><li>根据字段查询文档</li></ul><p>语法：db.集合.find(json)</p><pre><code>db.sysuser.find(&#123;_id:&quot;1&quot;&#125;)
</code></pre><ul><li>查询符合条件的第一条记录</li></ul><p>语法：db.集合.findOne(json);</p><ul><li>返回指定条数的记录</li></ul><p>语法：db.集合.find().limit(条数)</p><pre><code>db.sysuser.find().limit(2)
</code></pre><h3 id="3-3、修改和删除文档"><a href="#3-3、修改和删除文档" class="headerlink" title="3.3、修改和删除文档"></a>3.3、修改和删除文档</h3><h4 id="修改文档"><a href="#修改文档" class="headerlink" title="修改文档"></a>修改文档</h4><p>语法：db.集合.update(json条件,要更新的json)</p><p>注意：要使用修改器<code>$set</code>来实现,否则修改后其它字段都不见了</p><pre><code>db.sysuser.update(&#123;_id:&quot;1&quot;&#125;,&#123;$set:&#123;name:&quot;张三三&quot;&#125;&#125;)
</code></pre><h4 id="删除文档"><a href="#删除文档" class="headerlink" title="删除文档"></a>删除文档</h4><p>语法：db.集合.remove(json条件)</p><p>注意：条件不传则为全部删除(慎用！)</p><pre><code>db.sysuser.remove(&#123;_id:&quot;1&quot;&#125;);
</code></pre><h3 id="3-4、统计条数"><a href="#3-4、统计条数" class="headerlink" title="3.4、统计条数"></a>3.4、统计条数</h3><p>语法：db.集合.count(json条件)</p><p>注意：条件不传则统计集合所有数据</p><pre><code>db.sysuser.count();
db.sysuser.count(&#123;_id:&quot;1&quot;&#125;);
</code></pre><h3 id="3-5、模糊查询"><a href="#3-5、模糊查询" class="headerlink" title="3.5、模糊查询"></a>3.5、模糊查询</h3><p>MongoDB的模糊查询是通过正则表达式的方式实现的。格式为：</p><pre><code>/模糊查询字符串/
</code></pre><p>模糊查询姓名中带<code>张</code>的</p><pre><code>db.sysuser.find(&#123;name:/张/&#125;);
</code></pre><p>查询姓名中以<code>张</code>开头的</p><pre><code>db.sysuser.find(&#123;name:/^张/&#125;);
</code></pre><h3 id="3-6、大于-小于-不等于"><a href="#3-6、大于-小于-不等于" class="headerlink" title="3.6、大于 小于 不等于"></a>3.6、大于 小于 不等于</h3><p>&lt;, &lt;&#x3D;, &gt;, &gt;&#x3D; 这个操作符也是很常用的，格式如下:</p><pre><code>db.集合名称.find(&#123; &quot;field&quot; : &#123; $gt: value &#125;&#125;) // 大于: field &gt; value
db.集合名称.find(&#123; &quot;field&quot; : &#123; $lt: value &#125;&#125;) // 小于: field &lt; value
db.集合名称.find(&#123; &quot;field&quot; : &#123; $gte: value &#125;&#125;) // 大于等于: field &gt;= value
db.集合名称.find(&#123; &quot;field&quot; : &#123; $lte: value &#125;&#125;) // 小于等于: field &lt;= value
db.集合名称.find(&#123; &quot;field&quot; : &#123; $ne: value &#125;&#125;) // 不等于: field != value
</code></pre><p>查询年龄大于22岁的</p><pre><code>db.sysuser.find(&#123;&quot;age&quot;:&#123;$gt:18&#125;&#125;)
</code></pre><h3 id="3-7、包含与不包含"><a href="#3-7、包含与不包含" class="headerlink" title="3.7、包含与不包含"></a>3.7、包含与不包含</h3><ul><li>包含 <code>$in</code></li></ul><p>例如：查询_id包含1和2的</p><pre><code>db.sysuser.find(&#123;_id:&#123;$in:[&quot;1&quot;,&quot;2&quot;]&#125;&#125;);
</code></pre><ul><li>不包含 <code>$nin</code></li></ul><pre><code>db.sysuser.find(&#123;_id:&#123;$nin:[&quot;1&quot;,&quot;2&quot;]&#125;&#125;);
</code></pre><h3 id="3-8、条件连接"><a href="#3-8、条件连接" class="headerlink" title="3.8、条件连接"></a>3.8、条件连接</h3><p>如果需要查询同时满足两个以上条件，需要使用<code>$and</code>操作符将条件进行关联。（相当于SQL的and）<br>格式为：</p><pre><code>$and:[ &#123; &#125;,&#123; &#125;,&#123; &#125; ]
</code></pre><p>例如：查询_id大于等于2小于等于5的数据</p><pre><code>db.sysuser.find(&#123;$and:[&#123;_id:&#123;$gte:&quot;2&quot;&#125;&#125;,&#123;_id:&#123;$lte:&quot;5&quot;&#125;&#125;]&#125;)
</code></pre><p>如果两个以上条件之间是或者的关系，使用<code>$or</code>操作符进行关联，与前面and的使用方式相同<br>格式为：</p><pre><code>$or:[ &#123; &#125;,&#123; &#125;,&#123; &#125; ]
</code></pre><p>例如：查询_id不等于2或者大于等于4的</p><pre><code>db.sysuser.find(&#123;$or:[&#123;_id:&#123;$ne:&quot;2&quot;&#125;&#125;,&#123;_id:&#123;$gte:&quot;4&quot;&#125;&#125;]&#125;)
</code></pre><h3 id="3-9、列值增长"><a href="#3-9、列值增长" class="headerlink" title="3.9、列值增长"></a>3.9、列值增长</h3><p>如果想实现对某列值在原有值的基础上进行增加或减少，可以使用<code>$inc</code>运算符来实现</p><p>例如：让_id等于5的age增加1</p><pre><code>db.sysuser.update(&#123;_id:&quot;5&quot;&#125;,&#123;$inc:&#123;age:NumberInt(1)&#125;&#125;);
</code></pre><h2 id="4、java操作mongodb"><a href="#4、java操作mongodb" class="headerlink" title="4、java操作mongodb"></a>4、java操作mongodb</h2><p><code>mongodb-driver</code>是mongo官方推出的java连接mongoDB的驱动包，相当于JDBC驱动。<br>通过一个入门的案例来了解mongodb-driver的基本使用</p><h3 id="4-1、mongodb-driver"><a href="#4-1、mongodb-driver" class="headerlink" title="4.1、mongodb-driver"></a>4.1、mongodb-driver</h3><h4 id="4-1-1、查询全部"><a href="#4-1-1、查询全部" class="headerlink" title="4.1.1、查询全部"></a>4.1.1、查询全部</h4><ul><li>创建工程</li><li>引入依赖</li></ul><pre><code class="xml">&lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.mongodb&lt;/groupId&gt;
            &lt;artifactId&gt;mongodb-driver&lt;/artifactId&gt;
            &lt;version&gt;3.6.3&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
</code></pre><ul><li>创建测试类</li></ul><pre><code class="java">public class MongoDemo &#123;
    public static void main(String[] args) &#123;
        findAll();
    &#125;
    //查询所有
    public static void findAll()&#123;
        //创建连接对象
        MongoClient mongoClient = new MongoClient(&quot;127.0.0.1&quot;);
        //通过连接对象连接数据库
        MongoDatabase db = mongoClient.getDatabase(&quot;sys&quot;);
        //通过数据库获取集合
        MongoCollection&lt;Document&gt; sysuser = db.getCollection(&quot;sysuser&quot;);
        //通过集合获取文档
        FindIterable&lt;Document&gt; documents = sysuser.find();
        //遍历文档
        for (Document document : documents) &#123;
            String id = document.getString(&quot;_id&quot;);
            String name = document.getString(&quot;name&quot;);
            Integer age = document.getInteger(&quot;age&quot;);
            System.out.println(&quot;id=&quot;+id+&quot;,name=&quot;+name+&quot;,age=&quot;+age);
        &#125;
         //关闭连接
            mongoClient.close();
        
    &#125;
&#125;
</code></pre><h4 id="4-1-2、插入数据"><a href="#4-1-2、插入数据" class="headerlink" title="4.1.2、插入数据"></a>4.1.2、插入数据</h4><pre><code class="java">//插入
public static void insert()&#123;
    //创建连接对象
    MongoClient mongoClient = new MongoClient(&quot;127.0.0.1&quot;);
    //通过连接对象连接数据库
    MongoDatabase db = mongoClient.getDatabase(&quot;sys&quot;);
    //通过数据库获取集合
    MongoCollection&lt;Document&gt; sysuser = db.getCollection(&quot;sysuser&quot;);
    //插入数据
    Map map = new HashMap();
    map.put(&quot;_id&quot;,&quot;6&quot;);
    map.put(&quot;age&quot;,18);
    map.put(&quot;name&quot;,&quot;王八&quot;);
    Document document = new Document(map);
    sysuser.insertOne(document);
    //关闭连接
    mongoClient.close();

&#125;
</code></pre><h4 id="4-1-3、条件查询"><a href="#4-1-3、条件查询" class="headerlink" title="4.1.3、条件查询"></a>4.1.3、条件查询</h4><ul><li>查询id为1的记录</li></ul><pre><code class="java">//通过id查询
public static void findById()&#123;
    //创建连接对象
    MongoClient mongoClient = new MongoClient(&quot;127.0.0.1&quot;);
    //通过连接对象连接数据库
    MongoDatabase db = mongoClient.getDatabase(&quot;sys&quot;);
    //通过数据库获取集合
    MongoCollection&lt;Document&gt; sysuser = db.getCollection(&quot;sysuser&quot;);
    BasicDBObject bson = BasicDBObject.parse(&quot;&#123;_id:&#39;1&#39;&#125;&quot;);//构造查询json条件
    FindIterable&lt;Document&gt; documents = sysuser.find(bson);
    //遍历文档
    for (Document document : documents) &#123;
        String id = document.getString(&quot;_id&quot;);
        String name = document.getString(&quot;name&quot;);
        Integer age = document.getInteger(&quot;age&quot;);
        System.out.println(&quot;id=&quot;+id+&quot;,name=&quot;+name+&quot;,age=&quot;+age);
    &#125;

&#125;
</code></pre><ul><li>查询age大于等于22的记录</li></ul><pre><code class="java">//查询年龄大于等于22的记录
public static void findAge()&#123;
    //创建连接对象
    MongoClient mongoClient = new MongoClient(&quot;127.0.0.1&quot;);
    //通过连接对象连接数据库
    MongoDatabase db = mongoClient.getDatabase(&quot;sys&quot;);
    //通过数据库获取集合
    MongoCollection&lt;Document&gt; sysuser = db.getCollection(&quot;sysuser&quot;);
    BasicDBObject bson = BasicDBObject.parse(&quot;&#123;age:&#123;$gte:22&#125;&#125;&quot;);//构造查询条件
    FindIterable&lt;Document&gt; documents = sysuser.find(bson);
    //遍历文档
    for (Document document : documents) &#123;
        String id = document.getString(&quot;_id&quot;);
        String name = document.getString(&quot;name&quot;);
        Integer age = document.getInteger(&quot;age&quot;);
        System.out.println(&quot;id=&quot;+id+&quot;,name=&quot;+name+&quot;,age=&quot;+age);
    &#125;
&#125;
</code></pre><h3 id="4-2、SpringDataMongoDB"><a href="#4-2、SpringDataMongoDB" class="headerlink" title="4.2、SpringDataMongoDB"></a>4.2、SpringDataMongoDB</h3><p>SpringData家族成员之一，用于操作MongoDb的持久层框架，封装了底层的mongodb-driver</p><p>API类似SpringDataJPA</p><p>官网主页： <a target="_blank" rel="noopener" href="https://projects.spring.io/spring-data-mongodb/">https://projects.spring.io/spring-data-mongodb/</a></p><h4 id="4-2-1、创建工程"><a href="#4-2-1、创建工程" class="headerlink" title="4.2.1、创建工程"></a>4.2.1、创建工程</h4><ul><li>创建springboot工程</li><li>在pom.xml中引入mongo的依赖</li></ul><pre><code class="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-data-mongodb&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre><ul><li>application.yml</li></ul><pre><code class="yml">server:
  port: 8080
spring:
  application:
    name: springdatamongo #指定服务名
  datasource:
    driverClassName: com.mysql.jdbc.Driver
    url: jdbc:mysql://localhost:3306/vue?characterEncoding=utf-8
    username: root
    password: root
    type: com.zaxxer.hikari.HikariDataSource
  jackson:
    date-format: yyyy-MM-dd HH:mm:ss  #配置日期响应时的格式
    time-zone: GMT+8
  data: 
    mongodb:  #配置mongodb
      host: 127.0.0.1
      database: sysuser
</code></pre><h4 id="4-2-2、基本增删改查API的实现"><a href="#4-2-2、基本增删改查API的实现" class="headerlink" title="4.2.2、基本增删改查API的实现"></a>4.2.2、基本增删改查API的实现</h4><ul><li>创建实体类</li></ul><pre><code class="java">@Document(collection = &quot;sysuser&quot;)//配置对应的mongo集合
public class SysUser implements Serializable&#123;
    @Id
    private String _id;
    private String name;
    private Integer age;
    
    // getter and setter .....
&#125;
</code></pre><ul><li>创建dao</li></ul><pre><code class="java">public interface SysUserDao extends MongoRepository&lt;SysUser,String&gt; &#123;

&#125;
</code></pre><ul><li>创建service</li></ul><pre><code class="java">@Service
@Transactional
public class SysUserService &#123;

    @Autowired
    private SysUserDao sysUserDao;
    @Autowired
    private IdWorker idWorker;

    //查询所有
    public List&lt;SysUser&gt; findAll() &#123;
        List&lt;SysUser&gt; list = sysUserDao.findAll();
        System.out.println(&quot;==========&quot;+list);
        return list;
    &#125;
    //添加
    public void add() &#123;
        SysUser sysUser = new SysUser();
        sysUser.set_id(idWorker.nextString());
        sysUser.setAge(18);
        sysUser.setName(&quot;贺刘芳&quot;);
        sysUserDao.save(sysUser);
    &#125;
    //根据id查询
    public SysUser findById() &#123;
        return sysUserDao.findById(&quot;1&quot;).get();
    &#125;
    //删除
    public void remove() &#123;
        sysUserDao.deleteById(&quot;1277818770521460736&quot;);
    &#125;
    //修改
    public void modify() &#123;
        SysUser sysUser = new SysUser();
        sysUser.set_id(&quot;1&quot;);
        sysUser.setAge(58);
        sysUser.setName(&quot;扎三&quot;);
        sysUserDao.save(sysUser);
    &#125;
    //分页查询所有
    public Page&lt;SysUser&gt; findAll(Integer page, Integer size) &#123;
        PageRequest pageRequest = PageRequest.of(page - 1, size);
        return sysUserDao.findAll(pageRequest);
    &#125;
&#125;
</code></pre><ul><li>创建controller</li></ul><pre><code class="java">@RestController
@RequestMapping(&quot;/sysuser&quot;)
public class SysUserController &#123;

    @Autowired
    private SysUserService sysUserService;

    //查询全部
    @RequestMapping(&quot;findAll&quot;)
    public Result findAll()&#123;
        List&lt;SysUser&gt; sysUserList = sysUserService.findAll();
        return new Result(true, StatusCode.OK,&quot;ok&quot;,sysUserList);
    &#125;
    //根据id查询
    @RequestMapping(&quot;findById&quot;)
    public Result findById()&#123;
        SysUser sysUser = sysUserService.findById();
        return new Result(true, StatusCode.OK,&quot;ok&quot;,sysUser);
    &#125;
    //增加
    @RequestMapping(&quot;add&quot;)
    public Result add()&#123;
        sysUserService.add();
        return new Result(true, StatusCode.OK,&quot;ok&quot;);
    &#125;
    //修改
    @RequestMapping(&quot;modify&quot;)
    public Result modify()&#123;
        sysUserService.modify();
        return new Result(true, StatusCode.OK,&quot;ok&quot;);
    &#125;
    //删除
    @RequestMapping(&quot;remove&quot;)
    public Result remove()&#123;
        sysUserService.remove();
        return new Result(true, StatusCode.OK,&quot;ok&quot;);
    &#125;
    //分页查询所有
    @RequestMapping(&quot;findAllByPage&quot;)
    public Result findAllByPage(Integer page,Integer size)&#123;
        Page&lt;SysUser&gt; pageresult = sysUserService.findAll(page,size);
        return new Result(true, StatusCode.OK,&quot;ok&quot;,pageresult);
    &#125;
&#125;
</code></pre><h4 id="4-2-3、根据方法命名查询"><a href="#4-2-3、根据方法命名查询" class="headerlink" title="4.2.3、根据方法命名查询"></a>4.2.3、根据方法命名查询</h4><p>与SpringDataJPA类似</p><ul><li>controller</li></ul><pre><code class="java">//查询name中带有王的
@RequestMapping(&quot;findByNameLike&quot;)
public Result findByNameLike(Integer page,Integer size)&#123;
    Page&lt;SysUser&gt; pageresult = sysUserService.findByNameLike(page,size);
    return new Result(true, StatusCode.OK,&quot;ok&quot;,pageresult);
&#125;
</code></pre><ul><li>service</li></ul><pre><code class="java">public Page&lt;SysUser&gt; findByNameLike(Integer page, Integer size) &#123;
    PageRequest pageRequest = PageRequest.of(page - 1, size);
    return sysUserDao.findByNameLike(&quot;王&quot;,pageRequest);
&#125;
</code></pre><ul><li>dao</li></ul><pre><code class="java">public interface SysUserDao extends MongoRepository&lt;SysUser,String&gt; &#123;
    Page&lt;SysUser&gt; findByNameLike(String name, Pageable pageable);
&#125;
</code></pre><h4 id="4-2-4、使用MongoTemplate"><a href="#4-2-4、使用MongoTemplate" class="headerlink" title="4.2.4、使用MongoTemplate"></a>4.2.4、使用MongoTemplate</h4><p>首先需要注入<code>MongoTemplate</code></p><pre><code class="java">public class SysUserService &#123;

    @Autowired
    private MongoTemplate mongoTemplate;//注入操作mongo的模板对象
    
    //.......
&#125;
</code></pre><p>然后就可以通过MongoTemplate的API来操作Mongo了</p><ul><li>id为1的age的值增加1</li></ul><pre><code class="java">public void updateAge()&#123;
    Query query = new Query();
    query.addCriteria(Criteria.where(&quot;_id&quot;).is(&quot;1&quot;));
    Update update = new Update();
    update.inc(&quot;age&quot;,1);//让age的值自增1
    mongoTemplate.updateFirst(query,update,SysUser.class);
&#125;
</code></pre><ul><li>修改id为1的age和name字段</li></ul><pre><code class="java">public void update()&#123;
    Query query = new Query();
    query.addCriteria(Criteria.where(&quot;_id&quot;).is(&quot;1&quot;));
    Update update = new Update();
    //修改字段
    update.set(&quot;age&quot;,1);
    update.set(&quot;name&quot;,&quot;张撒&quot;);
    mongoTemplate.updateFirst(query,update,SysUser.class);
&#125;
</code></pre><h3 id="相关文档"><a href="#相关文档" class="headerlink" title="相关文档"></a>相关文档</h3><p><a target="_blank" rel="noopener" href="https://www.runoob.com/mongodb/mongodb-tutorial.html">https://www.runoob.com/mongodb/mongodb-tutorial.html</a></p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/sinat_35821285/article/details/83511203">https://blog.csdn.net/sinat_35821285/article/details/83511203</a></p></div><div class="post-ending"><div class="end-txt">------ 本文结束，感谢您的阅读 ------</div><blockquote class="layui-elem-quote layui-quote-nm" style="padding:10px"><div><span class="title">本文作者: </span>贺刘芳</div><div><span class="title">本文链接: </span><a target="_blank" href="https://heliufang.github.io/posts/b3b38c86/">https://heliufang.github.io/posts/b3b38c86/</a></div><div><span class="title">版权声明: </span>本文采用知识共享署名-非商业性使用-禁止演绎 2.5 中国大陆许可协议进行许可。</div></blockquote><div id="vcomments"></div></div></div></div></div><ul id="toTopBtn" class="layui-fixbar" style="right:-70px" title="置顶"><div><a href="javascript:void(0)" class="icon iconfont icon-huojian"></a></div></ul><div class="qy-footer"><div class="font-Area"><p>访客数 <span style="color:red" id="busuanzi_value_site_uv"><i class="layui-icon layui-icon-loading layui-anim layui-anim-rotate layui-anim-loop"></i></span> 人次 | 访问量 <span style="color:red" id="busuanzi_value_site_pv"><i class="layui-icon layui-icon-loading layui-anim layui-anim-rotate layui-anim-loop"></i></span> 次 | 本站已运行 <span style="color:red" id="runDaysFooter"><i class="layui-icon layui-icon-loading layui-anim layui-anim-rotate layui-anim-loop"></i></span> 天 | 本站文章字数合计 <span style="color:red">200.8k</span> | 最后更新于 <span style="color:red" id="lastUpdateFooter"><i class="layui-icon layui-icon-loading layui-anim layui-anim-rotate layui-anim-loop"></i></span></p><p>由 <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/index.html">Hexo</a> <span style="color:red" class="layui-icon layui-icon-find-fill layui-anim layui-anim-rotate layui-anim-loop"></span> 强力驱动</p><p>Copyright © 2020 ~<span id="currentYear">2022</span> <span class="layui-icon layui-icon-heart-fill footer-heart"></span> HeLiuFang</p></div></div></body><script src="../../js/jquery.min.js"></script><script src="../../js/moment.min.js"></script><script src="../../layui/layui.js"></script><script src="../../lib/prism/prism.js"></script><script>$("#searchBtn").click(function(){$("#searchShade").show(),$("#searchLayer").addClass("layui-anim layui-anim-scaleSpring")}),$("#closeBtn").click(function(){$("#searchShade").hide()});var searchFunc=function(t,i,o){$.ajax({url:t,dataType:"json",success:function(t){var e=document.getElementById(i),n=document.getElementById(o);e.addEventListener("input",function(){var e='<ul class="search-result-list">',o=this.value.trim().toLowerCase().split(/[\s\-]+/);n.innerHTML="",this.value.trim().length<=0||(t.forEach(function(t){var n=!0,i=t.title.trim().toLowerCase(),t=t.url;""!=i&&o.forEach(function(t,e){i.indexOf(t)<0?n=!1:i=i.replace(new RegExp(t,"g"),'<span style="color:red">'+t+"</span>")}),n&&(e=e+"<li><a href='"+t+"' class='search-result-title'>"+i+"</a></li>")}),e+="</ul>",n.innerHTML=e)})}})};function DynamicLine(){function t(t,e,n){return t.getAttribute(e)||n}function e(t){return document.getElementsByTagName(t)}function n(){r=o.width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,c=o.height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}function l(){var n,i,o,a,s;u.clearRect(0,0,r,c),y.forEach(function(t,e){for(t.x+=t.xa,t.y+=t.ya,t.xa*=t.x>r||t.x<0?-1:1,t.ya*=t.y>c||t.y<0?-1:1,u.fillRect(t.x-.5,t.y-.5,1,1),i=e+1;i<d.length;i++)null!==(n=d[i]).x&&null!==n.y&&(o=t.x-n.x,a=t.y-n.y,(s=o*o+a*a)<n.max)&&(n===w&&s>=n.max/2&&(t.x-=.03*o,t.y-=.03*a),o=(n.max-s)/n.max,u.beginPath(),u.lineWidth=o/2,u.strokeStyle="rgba("+h.c+","+(.2+o)+")",u.moveTo(t.x,t.y),u.lineTo(n.x,n.y),u.stroke())}),m(l)}var r,c,d,i,o=document.createElement("canvas"),h=(a=(i=e("script")).length,i=i[a-1],{l:a,z:t(i,"zIndex",-1),o:t(i,"opacity",.5),c:t(i,"color","0,0,50"),n:t(i,"count",99)}),a="c_n"+h.l,u=o.getContext("2d"),m=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/45)},s=Math.random,w={x:null,y:null,max:2e4};o.id=a,o.style.cssText="position:fixed;top:0;left:0;z-index:"+h.z+";opacity:"+h.o,e("body")[0].appendChild(o),n(),window.onresize=n,window.onmousemove=function(t){t=t||window.event,w.x=t.clientX,w.y=t.clientY},window.onmouseout=function(){w.x=null,w.y=null};for(var y=[],p=0;p<h.n;p++){var f=s()*r,x=s()*c,g=2*s()-1,v=2*s()-1;y.push({x:f,y:x,xa:g,ya:v,max:6e3})}d=y.concat([w]),setTimeout(function(){l()},100)}function clickEffect(){let o=[],n=!1,e,i=0,a,s,l,t,r;const c=["#F73859","#14FFEC","#00E0FF","#FF99FE","#FAF15D"],d=document.createElement("canvas"),h=(document.body.appendChild(d),d.setAttribute("style","width: 100%; height: 100%; top: 0; left: 0; z-index: 99999; position: fixed; pointer-events: none;"),document.createElement("span"));function u(){d.width=2*window.innerWidth,d.height=2*window.innerHeight,d.style.width=window.innerWidth+"px",d.style.height=window.innerHeight+"px",r.scale(2,2),a=d.width=window.innerWidth,s=d.height=window.innerHeight,l={x:a/2,y:s/2},t={x:a/2,y:s/2}}h.classList.add("pointer"),document.body.appendChild(h),d.getContext&&window.addEventListener?(r=d.getContext("2d"),u(),window.addEventListener("resize",u,!1),function t(){r.fillStyle="rgba(255, 255, 255, 0)";r.clearRect(0,0,d.width,d.height);for(let e=0;e<o.length;e++){let t=o[e];t.r<0||(r.fillStyle=t.color,r.beginPath(),r.arc(t.x,t.y,t.r,0,2*Math.PI,!1),r.fill(),t.update())}1==n?i+=.2:!n&&0<=i&&(i-=.4);p();requestAnimationFrame(t)}(),window.addEventListener("mousedown",function(t){w(y(10,20),t.clientX,t.clientY),document.body.classList.add("is-pressed"),e=setTimeout(function(){document.body.classList.add("is-longpress"),n=!0},500)},!1),window.addEventListener("mouseup",function(t){clearInterval(e),1==n&&(document.body.classList.remove("is-longpress"),w(y(50+Math.ceil(i),100+Math.ceil(i)),t.clientX,t.clientY),n=!1),document.body.classList.remove("is-pressed")},!1),window.addEventListener("mousemove",function(t){var e=t.clientX,t=t.clientY;h.style.top=t+"px",h.style.left=e+"px"},!1)):console.log("canvas or addEventListener is unsupported!");class m{constructor(t=l.x,e=l.y){this.x=t,this.y=e,this.angle=2*Math.PI*Math.random(),1==n?this.multiplier=y(14+i,15+i):this.multiplier=y(6,12),this.vx=(this.multiplier+.5*Math.random())*Math.cos(this.angle),this.vy=(this.multiplier+.5*Math.random())*Math.sin(this.angle),this.r=y(8,12)+3*Math.random(),this.color=c[Math.floor(Math.random()*c.length)]}update(){this.x+=this.vx-t.x,this.y+=this.vy-t.y,t.x=-2/window.innerWidth*Math.sin(this.angle),t.y=-2/window.innerHeight*Math.cos(this.angle),this.r-=.3,this.vx*=.9,this.vy*=.9}}function w(e=1,n=l.x,i=l.y){for(let t=0;t<e;t++)o.push(new m(n,i))}function y(t,e){return Math.floor(Math.random()*e)+t}function p(){for(let t=0;t<o.length;t++){var e=o[t];(e.x+e.r<0||e.x-e.r>a||e.y+e.r<0||e.y-e.r>s||e.r<0)&&o.splice(t,1)}}}searchFunc("/search.json","searchTxt","searchResult"),DynamicLine(),clickEffect(),document.querySelector("#currentYear").innerText=(new Date).getFullYear();var days=moment().diff($("#runDays")[0].dataset.sinceDate,"days"),lastUpdate=($("#runDays").html(days),$("#runDaysFooter").html(days),moment($("#lastUpdate")[0].dataset.lastUpdate,"YYYY-MM-DD HH:mm:ss").locale("zh-CN").fromNow());$("#lastUpdate").html(lastUpdate),$("#lastUpdateFooter").html(lastUpdate),$("#toTopBtn").click(function(){var t=$(window).scrollTop(),e=parseInt(t/60),n=setInterval(function(){$(window).scrollTop($(window).scrollTop()-e),0===$(window).scrollTop()&&clearInterval(n)},1)}),$.event.add(window,"scroll",function(){$("#toTopBtn").css("transform",0<$(window).scrollTop()?"translateX(-85px)":"translateX(85px)"),$("#toTopBtn").css("transition","all 0.5s")}),$("#loadingBox").hide(),$("body").css("overflow","auto")</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>var element=null;layui.use(["element"],function(){element=layui.element}),$(function(){var e=$("#toc-area"),t=$(e).offset().top;$.event.add(window,"scroll",function(){var o=$(".markdown-body").height(),o=(($(window).scrollTop()+t)/o*100).toFixed(2);element.progress("demo",(o=0==(o=99<o?100:o)?0:o)+"%"),$("#progressTxt").text(o),console.log("percent",o),$(e).css("position",$(window).scrollTop()>t?"fixed":"static"),$(e).css("top",$(window).scrollTop()>t?"60px":""),$("#tocMain").scrollTop($("#tocMain .toc").height()*o*.01)}),$("pre code").each(function(){var o=$(this).attr("class");o="language-"+(null==o||""==o||null==o?"plaintext":o),$(this).attr("class",o)}),$("pre").prepend('<div class="copy-to-clipboard-button"></div>')})</script></html>