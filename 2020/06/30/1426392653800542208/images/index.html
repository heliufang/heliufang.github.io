<html>

<head>
	<title>贺刘芳的搬砖日记</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link rel="stylesheet" href="../../../../../layui/css/layui.css" />
	<link rel="stylesheet" href="../../../../../css/common.css" />
	<link rel="stylesheet" href="../../../../../css/post.css" />
	<!-- 代码高亮 -->
	<link rel="stylesheet" href="../../../../../lib/prism/prism.css" />
	<link rel="shortcut icon" href="../../../../../img/favicon.ico">
<meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="atom.xml" title="贺刘芳的搬砖日记" type="application/atom+xml">
</head>

<body data-prismjs-copy="复制" data-prismjs-copy-success="复制成功!">
	<!-- 导航模板 -->
	<!-- 导航 -->
<div class="qy-nav">
  <ul class="layui-nav" lay-filter="" lay-bar="disabled" lay-unselect>
    <li class="layui-nav-item"><a class="title" href="/" style="padding: 0;">贺刘芳的搬砖日记</a></li>
    <li class="hide-xs layui-nav-item "><a href="/"><i class="layui-icon layui-icon-home"></i> 首页</a></li>
    <li class="hide-xs layui-nav-item "><a href="/archives"><i class="layui-icon layui-icon-date"></i> 归档</a></li>
    <li class="hide-xs layui-nav-item "><a href="/tags"><i class="layui-icon layui-icon-note"></i> 标签</a></li>
    <li class="hide-xs layui-nav-item "><a href="/categories"><i class="layui-icon layui-icon-template-1"></i> 分类</a>
    </li>
    <li class="hide-xs layui-nav-item "><a href="/about"><i class="layui-icon layui-icon-friends"></i> 关于</a></li>
    <li class="hide-xs layui-nav-item " id="searchBtn" style="float: right;"><a class="searchBtn" href="javascript:void(0);"><i
          class="layui-icon layui-icon-search"></i> 搜索</a></li>
    <li class="layui-nav-item hide-sm hide-md hide-lg" style="float: right">
      <a href="javascript:;">菜单</a>
      <dl class="layui-nav-child"> <!-- 二级菜单 -->
        <dd><a href="/">首页</a></dd>
        <dd><a href="/archives">归档</a></dd>
        <dd><a href="/tags">标签</a></dd>
        <dd><a href="/categories">分类</a></dd>
        <dd><a href="/about">关于</a></dd>
        <dd><a href="javascript:void(0)" onclick="document.querySelector('#searchShade').style.display = 'block'">搜索</a>
        </dd>
      </dl>
    </li>
  </ul>
  <!-- 进度条 -->
  <div class="progress" id="progressNav"></div>
  <!-- loading -->
  <div id="loadingBox" class="loadingBox">
    <img src="/img/loading.gif">
  </div>
</div>
<!-- 搜索弹框 -->
<div id="searchShade" class="searchShade">
  <div id="searchLayer">
    <div id="closeBtn" class="close"><i class="layui-icon layui-icon-close"></i></div>
    <input id="searchTxt" type="text" placeholder="搜索文章(只支持文章标题关键字)" />
    <div id="searchResult">
      <!-- <ul>
        <li>java笔记
        <li>
      </ul> -->
    </div>

  </div>
</div>

		<!-- 中间内容区域 -->
		<div class="layui-container  center" id="top">
			<div class="layui-row layui-col-space20">
				<div class="layui-col-md3 hide-xs hide-sm">
					<!-- 左侧的公告、分类、归档、标签 -->
					<!-- 左侧的公告、分类、归档、标签 -->

<!-- 个人信息 -->
<div class="layui-card">
    <div class="layui-card-header"><i style="font-weight: bold;" class="layui-icon layui-icon-speaker"></i> 公告</div>
    <div class="layui-card-body">
        <div class="userinfo">
            <img src="/head.png">
            <div class="name">淡泊明志，宁静致远</div>
            <div class="other">
                <div class="item">
                    <p class="num">
                        40
                    </p>
                    <p class="title">文章</p>
                </div>
                <div class="item">
                    <p class="num">
                        8
                    </p>
                    <p class="title">分类</p>
                </div>
                <div class="item">
                    <p class="num">
                        44
                    </p>
                    <p class="title">标签</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 最新文章 -->
<div class="layui-card">
    <div class="layui-card-header"><i style="font-weight: bold;" class="layui-icon layui-icon-time"></i> 最新文章</div>
    <div class="layui-card-body">
        
        <ul>
            
                <li><a href="/2022/12/30/1608754051799977984/images/">1.react笔记</a></li>
            
                <li><a href="/2022/12/09/1601805950963027968/images/">2.vue3.2新特性笔记</a></li>
            
                <li><a href="/2022/10/30/1593064784100724736/images/">3.node笔记</a></li>
            
                <li><a href="/2022/07/09/1545789245413789696/images/">4.vue3笔记</a></li>
            
                <li><a href="/2022/07/09/1551862167303753728/images/">5.TypeScript笔记</a></li>
            
        </ul>
    </div>
</div>

<!-- 分类 -->
<div class="layui-card">
    <div class="layui-card-header"><i style="font-weight: bold;" class="layui-icon layui-icon-template-1"></i> 分类</div>
    <div class="layui-card-body">
        <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="../../../../../categories/java/">java</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="../../../../../categories/linux/">linux</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="../../../../../categories/vue/">vue</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="../../../../../categories/web%E5%89%8D%E7%AB%AF/">web前端</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="../../../../../categories/%E5%85%AC%E4%BC%97%E5%8F%B7%E5%92%8C%E5%B0%8F%E7%A8%8B%E5%BA%8F/">公众号和小程序</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="../../../../../categories/%E5%85%B6%E5%AE%83%E6%8A%80%E6%9C%AF/">其它技术</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="../../../../../categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">开发工具</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="../../../../../categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><span class="category-list-count">2</span></li></ul>
    </div>
</div>


						<!-- 文章目录 -->
						
							<div style="height: calc(100% - 60px - 60px - 10px);width: 267px;" id="toc-area" class="layui-card">
								<div class="layui-card-header"><i class="layui-icon layui-icon-form"></i> 本文目录</div>
								<div id="tocMain" class="layui-card-body"
									style="overflow:auto;height: calc(100% - 60px - 60px);">
									<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81MongoDB%E7%AE%80%E4%BB%8B"><span class="toc-text">1、MongoDB简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AFMongoDB"><span class="toc-text">1.1、什么是MongoDB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2%E3%80%81MongoDB%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="toc-text">1.2、MongoDB体系结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3%E3%80%81%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text">1.3、数据类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-MongoDB-%E5%AE%89%E8%A3%85"><span class="toc-text">2.MongoDB 安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E3%80%81windows%E5%AE%89%E8%A3%85"><span class="toc-text">2.1 、windows安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2%E3%80%81linux%E5%AE%89%E8%A3%85"><span class="toc-text">2.2、linux安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3%E3%80%81docker%E5%AE%89%E8%A3%85"><span class="toc-text">2.3、docker安装</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-text">3、常用命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1%E3%80%81%E9%80%89%E6%8B%A9%E5%92%8C%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">3.1、选择和创建数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2%E3%80%81%E6%8F%92%E5%85%A5%E4%B8%8E%E6%9F%A5%E8%AF%A2%E6%96%87%E6%A1%A3"><span class="toc-text">3.2、插入与查询文档</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E6%96%87%E6%A1%A3"><span class="toc-text">插入文档</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%96%87%E6%A1%A3"><span class="toc-text">查询文档</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3%E3%80%81%E4%BF%AE%E6%94%B9%E5%92%8C%E5%88%A0%E9%99%A4%E6%96%87%E6%A1%A3"><span class="toc-text">3.3、修改和删除文档</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%96%87%E6%A1%A3"><span class="toc-text">修改文档</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%96%87%E6%A1%A3"><span class="toc-text">删除文档</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4%E3%80%81%E7%BB%9F%E8%AE%A1%E6%9D%A1%E6%95%B0"><span class="toc-text">3.4、统计条数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5%E3%80%81%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2"><span class="toc-text">3.5、模糊查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6%E3%80%81%E5%A4%A7%E4%BA%8E-%E5%B0%8F%E4%BA%8E-%E4%B8%8D%E7%AD%89%E4%BA%8E"><span class="toc-text">3.6、大于 小于 不等于</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-7%E3%80%81%E5%8C%85%E5%90%AB%E4%B8%8E%E4%B8%8D%E5%8C%85%E5%90%AB"><span class="toc-text">3.7、包含与不包含</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-8%E3%80%81%E6%9D%A1%E4%BB%B6%E8%BF%9E%E6%8E%A5"><span class="toc-text">3.8、条件连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-9%E3%80%81%E5%88%97%E5%80%BC%E5%A2%9E%E9%95%BF"><span class="toc-text">3.9、列值增长</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81java%E6%93%8D%E4%BD%9Cmongodb"><span class="toc-text">4、java操作mongodb</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1%E3%80%81mongodb-driver"><span class="toc-text">4.1、mongodb-driver</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-1%E3%80%81%E6%9F%A5%E8%AF%A2%E5%85%A8%E9%83%A8"><span class="toc-text">4.1.1、查询全部</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-2%E3%80%81%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-text">4.1.2、插入数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-3%E3%80%81%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2"><span class="toc-text">4.1.3、条件查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2%E3%80%81SpringDataMongoDB"><span class="toc-text">4.2、SpringDataMongoDB</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1%E3%80%81%E5%88%9B%E5%BB%BA%E5%B7%A5%E7%A8%8B"><span class="toc-text">4.2.1、创建工程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2%E3%80%81%E5%9F%BA%E6%9C%AC%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5API%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-text">4.2.2、基本增删改查API的实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-3%E3%80%81%E6%A0%B9%E6%8D%AE%E6%96%B9%E6%B3%95%E5%91%BD%E5%90%8D%E6%9F%A5%E8%AF%A2"><span class="toc-text">4.2.3、根据方法命名查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-4%E3%80%81%E4%BD%BF%E7%94%A8MongoTemplate"><span class="toc-text">4.2.4、使用MongoTemplate</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%96%87%E6%A1%A3"><span class="toc-text">相关文档</span></a></li></ol></li></ol>
								</div>
								<div class="readprocess">
									<div><i class="layui-icon layui-icon-read"></i> 已阅读：<span id="progressTxt"></span>%
									</div>
									<div class="layui-progress" lay-filter="demo">
										<div class="layui-progress-bar" lay-percent="10%"></div>
									</div>
								</div>
							</div>
							
				</div>
				<div class="layui-col-md9 markdown-body" style="background:#fff;margin-top: 10px;">
					
						<div class="article-title">
							<h1>MongoDB笔记</h1>
							<p>
								<i class="layui-icon layui-icon-date"></i>发表时间 2020-06-30
									|
									<i class="layui-icon layui-icon-form"></i>累计字数 3.4k
							</p>
						</div>
						
						<!-- 文章内容 -->
						<div id="article">
							<h2 id="1、MongoDB简介"><a href="#1、MongoDB简介" class="headerlink" title="1、MongoDB简介"></a>1、MongoDB简介</h2><h3 id="1-1、什么是MongoDB"><a href="#1-1、什么是MongoDB" class="headerlink" title="1.1、什么是MongoDB"></a>1.1、什么是MongoDB</h3><p>MongoDB 是一个跨平台的，面向文档的数据库，是当前 NoSQL 数据库产品中最热<br>门的一种。它介于关系数据库和非关系数据库之间，是非关系数据库当中功能最丰富，最<br>像关系数据库的产品。它支持的数据结构非常松散，是类似 JSON 的 BSON 格式，因此可以<br>存储比较复杂的数据类型。</p>
<p>对于数据量较大且价值较低的数据，可以使用mongodb减轻mysql的压力</p>
<p>MongoDB 的官方网站地址是：<a target="_blank" rel="noopener" href="http://www.mongodb.org/">http://www.mongodb.org/</a></p>
<p><img src="/2020/06/30/1426392653800542208/images/1592807836805.png" alt="1592807836805"></p>
<h3 id="1-2、MongoDB体系结构"><a href="#1-2、MongoDB体系结构" class="headerlink" title="1.2、MongoDB体系结构"></a>1.2、MongoDB体系结构</h3><p>MongoDB 的逻辑结构是一种层次结构。主要由：<br><code>文档(document)</code>、<code>集合(collection)</code>、<code>数据库(database)</code>这三部分组成的。逻辑结构是面<br>向用户的，用户使用 MongoDB 开发应用程序使用的就是逻辑结构。<br>（1）MongoDB 的文档（document），相当于关系数据库中的一行记录。<br>（2）多个文档组成一个集合（collection），相当于关系数据库的表。<br>（3）多个集合（collection），逻辑上组织在一起，就是数据库（database）。<br>（4）一个 MongoDB 实例支持多个数据库（database）。<br>文档(document)、集合(collection)、数据库(database)的层次结构如下图:</p>
<p><img src="/2020/06/30/1426392653800542208/images/1592807996776.png" alt="1592807996776"></p>
<p>下表是MongoDB与MySQL数据库逻辑结构概念的对比:</p>
<table>
<thead>
<tr>
<th>MongoDb 关系型</th>
<th>数据库Mysql</th>
</tr>
</thead>
<tbody><tr>
<td>数据库(databases)</td>
<td>数据库(databases)</td>
</tr>
<tr>
<td>集合(collections)</td>
<td>表(table)</td>
</tr>
<tr>
<td>文档(document)</td>
<td>行(row)</td>
</tr>
</tbody></table>
<h3 id="1-3、数据类型"><a href="#1-3、数据类型" class="headerlink" title="1.3、数据类型"></a>1.3、数据类型</h3><p>null：用于表示空值或者不存在的字段，{“x”:null}<br>布尔型：布尔类型有两个值true和false，{“x”:true}<br>数值：shell默认使用64位浮点型数值。{“x”：3.14}或{“x”：3}。对于整型值，可以使用<br>NumberInt（4字节符号整数）或NumberLong（8字节符号整数），<br>{“x”:NumberInt(“3”)}{“x”:NumberLong(“3”)}<br>字符串：UTF-8字符串都可以表示为字符串类型的数据，{“x”：“呵呵”}<br>日期：日期被存储为自新纪元依赖经过的毫秒数，不存储时区，{“x”:new Date()}</p>
<p>正则表达式：查询时，使用正则表达式作为限定条件，语法与JavaScript的正则表达式相<br>同，{“x”:&#x2F;[abc]&#x2F;}<br>数组：数据列表或数据集可以表示为数组，{“x”： [“a“，“b”,”c”]}<br>内嵌文档：文档可以嵌套其他文档，被嵌套的文档作为值来处理，{“x”:{“y”:3 }}<br>对象Id：对象id是一个12字节的字符串，是文档的唯一标识，{“x”: objectId() }<br>二进制数据：二进制数据是一个任意字节的字符串。它不能直接在shell中使用。如果要<br>将非utf-字符保存到数据库中，二进制数据是唯一的方式。<br>代码：查询和文档中可以包括任何JavaScript代码，{“x”:function(){&#x2F;…&#x2F;}}</p>
<h2 id="2-MongoDB-安装"><a href="#2-MongoDB-安装" class="headerlink" title="2.MongoDB 安装"></a>2.MongoDB 安装</h2><h3 id="2-1-、windows安装"><a href="#2-1-、windows安装" class="headerlink" title="2.1 、windows安装"></a>2.1 、windows安装</h3><ul>
<li>双击mongodb-win32-x86_64-2008plusssl-3.2.10-signed.msi 一直点下一步</li>
<li>安装完后建立MongoDB存数据的文件夹：C:\data\db</li>
<li>在MongoDB的安装目录下的bin目录下打开cmd窗口，输入一下命令启动窗口</li>
</ul>
<pre><code>mongod --dbpath c:\data\db
</code></pre>
<p> ps:为了启动方便也可以写一个startup.bat文件将上面的命令写入。</p>
<h3 id="2-2、linux安装"><a href="#2-2、linux安装" class="headerlink" title="2.2、linux安装"></a>2.2、linux安装</h3><h3 id="2-3、docker安装"><a href="#2-3、docker安装" class="headerlink" title="2.3、docker安装"></a>2.3、docker安装</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/helf/p/13188265.html">https://www.cnblogs.com/helf/p/13188265.html</a></p>
<h2 id="3、常用命令"><a href="#3、常用命令" class="headerlink" title="3、常用命令"></a>3、常用命令</h2><h3 id="3-1、选择和创建数据库"><a href="#3-1、选择和创建数据库" class="headerlink" title="3.1、选择和创建数据库"></a>3.1、选择和创建数据库</h3><p>语法格式：</p>
<pre><code>use 数据库名称
</code></pre>
<p>ps:如果数据库不存在则自动创建</p>
<p>以下为创建sys数据库</p>
<pre><code>use sys
</code></pre>
<h3 id="3-2、插入与查询文档"><a href="#3-2、插入与查询文档" class="headerlink" title="3.2、插入与查询文档"></a>3.2、插入与查询文档</h3><h4 id="插入文档"><a href="#插入文档" class="headerlink" title="插入文档"></a>插入文档</h4><pre><code>db.sysuser.insert(&#123;_id:&quot;1&quot;,name:&quot;张三&quot;,age:NumberInt(18)&#125;);
</code></pre>
<p>插入文档的语法格式：</p>
<pre><code>db.集合名称.insert(json数据);
</code></pre>
<p>例如：</p>
<pre><code> db.sysuser.insert(&#123;_id:&quot;1&quot;,name:&quot;张三&quot;,age:NumberInt(18)&#125;);
</code></pre>
<p>每条文档会有一个叫<code>_id</code>的字段，这个相当于关系数据库中表的主键，当插入文档记录时没有指定该字段MongoDB会自动创建，其类型是<code>ObjectID</code>类型。如果在插入文档记录时指定该字段也可以，其类型可以是ObjectID类型，也可以是MongoDB支持的任意类型。</p>
<h4 id="查询文档"><a href="#查询文档" class="headerlink" title="查询文档"></a>查询文档</h4><p>先插入一些数据</p>
<pre><code>db.sysuser.insert(&#123;_id:&quot;2&quot;,name:&quot;李四&quot;,age:NumberInt(21)&#125;);
db.sysuser.insert(&#123;_id:&quot;3&quot;,name:&quot;王五&quot;,age:NumberInt(28)&#125;);
db.sysuser.insert(&#123;_id:&quot;4&quot;,name:&quot;赵柳&quot;,age:NumberInt(22)&#125;);
db.sysuser.insert(&#123;_id:&quot;5&quot;,name:&quot;田七&quot;,age:NumberInt(23)&#125;);
</code></pre>
<ul>
<li>查询集合的所有数据</li>
</ul>
<p>语法：db.集合.find()</p>
<pre><code>db.sysuser.find()
</code></pre>
<ul>
<li>根据字段查询文档</li>
</ul>
<p>语法：db.集合.find(json)</p>
<pre><code>db.sysuser.find(&#123;_id:&quot;1&quot;&#125;)
</code></pre>
<ul>
<li>查询符合条件的第一条记录</li>
</ul>
<p>语法：db.集合.findOne(json);</p>
<ul>
<li>返回指定条数的记录</li>
</ul>
<p>语法：db.集合.find().limit(条数)</p>
<pre><code>db.sysuser.find().limit(2)
</code></pre>
<h3 id="3-3、修改和删除文档"><a href="#3-3、修改和删除文档" class="headerlink" title="3.3、修改和删除文档"></a>3.3、修改和删除文档</h3><h4 id="修改文档"><a href="#修改文档" class="headerlink" title="修改文档"></a>修改文档</h4><p>语法：db.集合.update(json条件,要更新的json)</p>
<p>注意：要使用修改器<code>$set</code>来实现,否则修改后其它字段都不见了</p>
<pre><code>db.sysuser.update(&#123;_id:&quot;1&quot;&#125;,&#123;$set:&#123;name:&quot;张三三&quot;&#125;&#125;)
</code></pre>
<h4 id="删除文档"><a href="#删除文档" class="headerlink" title="删除文档"></a>删除文档</h4><p>语法：db.集合.remove(json条件) </p>
<p>注意：条件不传则为全部删除(慎用！)</p>
<pre><code>db.sysuser.remove(&#123;_id:&quot;1&quot;&#125;);
</code></pre>
<h3 id="3-4、统计条数"><a href="#3-4、统计条数" class="headerlink" title="3.4、统计条数"></a>3.4、统计条数</h3><p>语法：db.集合.count(json条件)  </p>
<p>注意：条件不传则统计集合所有数据</p>
<pre><code>db.sysuser.count();
db.sysuser.count(&#123;_id:&quot;1&quot;&#125;);
</code></pre>
<h3 id="3-5、模糊查询"><a href="#3-5、模糊查询" class="headerlink" title="3.5、模糊查询"></a>3.5、模糊查询</h3><p>MongoDB的模糊查询是通过正则表达式的方式实现的。格式为：</p>
<pre><code>/模糊查询字符串/
</code></pre>
<p>模糊查询姓名中带<code>张</code>的</p>
<pre><code>db.sysuser.find(&#123;name:/张/&#125;);
</code></pre>
<p>查询姓名中以<code>张</code>开头的</p>
<pre><code>db.sysuser.find(&#123;name:/^张/&#125;);
</code></pre>
<h3 id="3-6、大于-小于-不等于"><a href="#3-6、大于-小于-不等于" class="headerlink" title="3.6、大于 小于 不等于"></a>3.6、大于 小于 不等于</h3><p>&lt;, &lt;&#x3D;, &gt;, &gt;&#x3D; 这个操作符也是很常用的，格式如下:</p>
<pre><code>db.集合名称.find(&#123; &quot;field&quot; : &#123; $gt: value &#125;&#125;) // 大于: field &gt; value
db.集合名称.find(&#123; &quot;field&quot; : &#123; $lt: value &#125;&#125;) // 小于: field &lt; value
db.集合名称.find(&#123; &quot;field&quot; : &#123; $gte: value &#125;&#125;) // 大于等于: field &gt;= value
db.集合名称.find(&#123; &quot;field&quot; : &#123; $lte: value &#125;&#125;) // 小于等于: field &lt;= value
db.集合名称.find(&#123; &quot;field&quot; : &#123; $ne: value &#125;&#125;) // 不等于: field != value
</code></pre>
<p>查询年龄大于22岁的</p>
<pre><code>db.sysuser.find(&#123;&quot;age&quot;:&#123;$gt:18&#125;&#125;)
</code></pre>
<h3 id="3-7、包含与不包含"><a href="#3-7、包含与不包含" class="headerlink" title="3.7、包含与不包含"></a>3.7、包含与不包含</h3><ul>
<li>包含   <code>$in</code></li>
</ul>
<p>例如：查询_id包含1和2的</p>
<pre><code>db.sysuser.find(&#123;_id:&#123;$in:[&quot;1&quot;,&quot;2&quot;]&#125;&#125;);
</code></pre>
<ul>
<li>不包含 <code> $nin</code></li>
</ul>
<pre><code>db.sysuser.find(&#123;_id:&#123;$nin:[&quot;1&quot;,&quot;2&quot;]&#125;&#125;);
</code></pre>
<h3 id="3-8、条件连接"><a href="#3-8、条件连接" class="headerlink" title="3.8、条件连接"></a>3.8、条件连接</h3><p>如果需要查询同时满足两个以上条件，需要使用<code>$and</code>操作符将条件进行关联。（相当于SQL的and）<br>格式为：</p>
<pre><code>$and:[ &#123; &#125;,&#123; &#125;,&#123; &#125; ]
</code></pre>
<p>例如：查询_id大于等于2小于等于5的数据</p>
<pre><code>db.sysuser.find(&#123;$and:[&#123;_id:&#123;$gte:&quot;2&quot;&#125;&#125;,&#123;_id:&#123;$lte:&quot;5&quot;&#125;&#125;]&#125;)
</code></pre>
<p>如果两个以上条件之间是或者的关系，使用<code>$or</code>操作符进行关联，与前面and的使用方式相同<br>格式为：</p>
<pre><code>$or:[ &#123; &#125;,&#123; &#125;,&#123; &#125; ]
</code></pre>
<p>例如：查询_id不等于2或者大于等于4的</p>
<pre><code>db.sysuser.find(&#123;$or:[&#123;_id:&#123;$ne:&quot;2&quot;&#125;&#125;,&#123;_id:&#123;$gte:&quot;4&quot;&#125;&#125;]&#125;)
</code></pre>
<h3 id="3-9、列值增长"><a href="#3-9、列值增长" class="headerlink" title="3.9、列值增长"></a>3.9、列值增长</h3><p>如果想实现对某列值在原有值的基础上进行增加或减少，可以使用<code>$inc</code>运算符来实现</p>
<p>例如：让_id等于5的age增加1</p>
<pre><code>db.sysuser.update(&#123;_id:&quot;5&quot;&#125;,&#123;$inc:&#123;age:NumberInt(1)&#125;&#125;);
</code></pre>
<h2 id="4、java操作mongodb"><a href="#4、java操作mongodb" class="headerlink" title="4、java操作mongodb"></a>4、java操作mongodb</h2><p><code>mongodb-driver</code>是mongo官方推出的java连接mongoDB的驱动包，相当于JDBC驱动。<br>通过一个入门的案例来了解mongodb-driver的基本使用</p>
<h3 id="4-1、mongodb-driver"><a href="#4-1、mongodb-driver" class="headerlink" title="4.1、mongodb-driver"></a>4.1、mongodb-driver</h3><h4 id="4-1-1、查询全部"><a href="#4-1-1、查询全部" class="headerlink" title="4.1.1、查询全部"></a>4.1.1、查询全部</h4><ul>
<li>创建工程</li>
<li>引入依赖</li>
</ul>
<pre><code class="xml">&lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.mongodb&lt;/groupId&gt;
            &lt;artifactId&gt;mongodb-driver&lt;/artifactId&gt;
            &lt;version&gt;3.6.3&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
</code></pre>
<ul>
<li>创建测试类</li>
</ul>
<pre><code class="java">public class MongoDemo &#123;
    public static void main(String[] args) &#123;
        findAll();
    &#125;
    //查询所有
    public static void findAll()&#123;
        //创建连接对象
        MongoClient mongoClient = new MongoClient(&quot;127.0.0.1&quot;);
        //通过连接对象连接数据库
        MongoDatabase db = mongoClient.getDatabase(&quot;sys&quot;);
        //通过数据库获取集合
        MongoCollection&lt;Document&gt; sysuser = db.getCollection(&quot;sysuser&quot;);
        //通过集合获取文档
        FindIterable&lt;Document&gt; documents = sysuser.find();
        //遍历文档
        for (Document document : documents) &#123;
            String id = document.getString(&quot;_id&quot;);
            String name = document.getString(&quot;name&quot;);
            Integer age = document.getInteger(&quot;age&quot;);
            System.out.println(&quot;id=&quot;+id+&quot;,name=&quot;+name+&quot;,age=&quot;+age);
        &#125;
         //关闭连接
            mongoClient.close();
        
    &#125;
&#125;
</code></pre>
<h4 id="4-1-2、插入数据"><a href="#4-1-2、插入数据" class="headerlink" title="4.1.2、插入数据"></a>4.1.2、插入数据</h4><pre><code class="java">//插入
public static void insert()&#123;
    //创建连接对象
    MongoClient mongoClient = new MongoClient(&quot;127.0.0.1&quot;);
    //通过连接对象连接数据库
    MongoDatabase db = mongoClient.getDatabase(&quot;sys&quot;);
    //通过数据库获取集合
    MongoCollection&lt;Document&gt; sysuser = db.getCollection(&quot;sysuser&quot;);
    //插入数据
    Map map = new HashMap();
    map.put(&quot;_id&quot;,&quot;6&quot;);
    map.put(&quot;age&quot;,18);
    map.put(&quot;name&quot;,&quot;王八&quot;);
    Document document = new Document(map);
    sysuser.insertOne(document);
    //关闭连接
    mongoClient.close();

&#125;
</code></pre>
<h4 id="4-1-3、条件查询"><a href="#4-1-3、条件查询" class="headerlink" title="4.1.3、条件查询"></a>4.1.3、条件查询</h4><ul>
<li>查询id为1的记录</li>
</ul>
<pre><code class="java">//通过id查询
public static void findById()&#123;
    //创建连接对象
    MongoClient mongoClient = new MongoClient(&quot;127.0.0.1&quot;);
    //通过连接对象连接数据库
    MongoDatabase db = mongoClient.getDatabase(&quot;sys&quot;);
    //通过数据库获取集合
    MongoCollection&lt;Document&gt; sysuser = db.getCollection(&quot;sysuser&quot;);
    BasicDBObject bson = BasicDBObject.parse(&quot;&#123;_id:&#39;1&#39;&#125;&quot;);//构造查询json条件
    FindIterable&lt;Document&gt; documents = sysuser.find(bson);
    //遍历文档
    for (Document document : documents) &#123;
        String id = document.getString(&quot;_id&quot;);
        String name = document.getString(&quot;name&quot;);
        Integer age = document.getInteger(&quot;age&quot;);
        System.out.println(&quot;id=&quot;+id+&quot;,name=&quot;+name+&quot;,age=&quot;+age);
    &#125;

&#125;
</code></pre>
<ul>
<li>查询age大于等于22的记录</li>
</ul>
<pre><code class="java">//查询年龄大于等于22的记录
public static void findAge()&#123;
    //创建连接对象
    MongoClient mongoClient = new MongoClient(&quot;127.0.0.1&quot;);
    //通过连接对象连接数据库
    MongoDatabase db = mongoClient.getDatabase(&quot;sys&quot;);
    //通过数据库获取集合
    MongoCollection&lt;Document&gt; sysuser = db.getCollection(&quot;sysuser&quot;);
    BasicDBObject bson = BasicDBObject.parse(&quot;&#123;age:&#123;$gte:22&#125;&#125;&quot;);//构造查询条件
    FindIterable&lt;Document&gt; documents = sysuser.find(bson);
    //遍历文档
    for (Document document : documents) &#123;
        String id = document.getString(&quot;_id&quot;);
        String name = document.getString(&quot;name&quot;);
        Integer age = document.getInteger(&quot;age&quot;);
        System.out.println(&quot;id=&quot;+id+&quot;,name=&quot;+name+&quot;,age=&quot;+age);
    &#125;
&#125;
</code></pre>
<h3 id="4-2、SpringDataMongoDB"><a href="#4-2、SpringDataMongoDB" class="headerlink" title="4.2、SpringDataMongoDB"></a>4.2、SpringDataMongoDB</h3><p>SpringData家族成员之一，用于操作MongoDb的持久层框架，封装了底层的mongodb-driver</p>
<p>API类似SpringDataJPA</p>
<p>官网主页： <a target="_blank" rel="noopener" href="https://projects.spring.io/spring-data-mongodb/">https://projects.spring.io/spring-data-mongodb/</a></p>
<h4 id="4-2-1、创建工程"><a href="#4-2-1、创建工程" class="headerlink" title="4.2.1、创建工程"></a>4.2.1、创建工程</h4><ul>
<li>创建springboot工程</li>
<li>在pom.xml中引入mongo的依赖</li>
</ul>
<pre><code class="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-data-mongodb&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<ul>
<li>application.yml</li>
</ul>
<pre><code class="yml">server:
  port: 8080
spring:
  application:
    name: springdatamongo #指定服务名
  datasource:
    driverClassName: com.mysql.jdbc.Driver
    url: jdbc:mysql://localhost:3306/vue?characterEncoding=utf-8
    username: root
    password: root
    type: com.zaxxer.hikari.HikariDataSource
  jackson:
    date-format: yyyy-MM-dd HH:mm:ss  #配置日期响应时的格式
    time-zone: GMT+8
  data: 
    mongodb:  #配置mongodb
      host: 127.0.0.1
      database: sysuser
</code></pre>
<h4 id="4-2-2、基本增删改查API的实现"><a href="#4-2-2、基本增删改查API的实现" class="headerlink" title="4.2.2、基本增删改查API的实现"></a>4.2.2、基本增删改查API的实现</h4><ul>
<li>创建实体类</li>
</ul>
<pre><code class="java">@Document(collection = &quot;sysuser&quot;)//配置对应的mongo集合
public class SysUser implements Serializable&#123;
    @Id
    private String _id;
    private String name;
    private Integer age;
    
    // getter and setter .....
&#125;
</code></pre>
<ul>
<li>创建dao</li>
</ul>
<pre><code class="java">public interface SysUserDao extends MongoRepository&lt;SysUser,String&gt; &#123;

&#125;
</code></pre>
<ul>
<li>创建service</li>
</ul>
<pre><code class="java">@Service
@Transactional
public class SysUserService &#123;

    @Autowired
    private SysUserDao sysUserDao;
    @Autowired
    private IdWorker idWorker;

    //查询所有
    public List&lt;SysUser&gt; findAll() &#123;
        List&lt;SysUser&gt; list = sysUserDao.findAll();
        System.out.println(&quot;==========&quot;+list);
        return list;
    &#125;
    //添加
    public void add() &#123;
        SysUser sysUser = new SysUser();
        sysUser.set_id(idWorker.nextString());
        sysUser.setAge(18);
        sysUser.setName(&quot;贺刘芳&quot;);
        sysUserDao.save(sysUser);
    &#125;
    //根据id查询
    public SysUser findById() &#123;
        return sysUserDao.findById(&quot;1&quot;).get();
    &#125;
    //删除
    public void remove() &#123;
        sysUserDao.deleteById(&quot;1277818770521460736&quot;);
    &#125;
    //修改
    public void modify() &#123;
        SysUser sysUser = new SysUser();
        sysUser.set_id(&quot;1&quot;);
        sysUser.setAge(58);
        sysUser.setName(&quot;扎三&quot;);
        sysUserDao.save(sysUser);
    &#125;
    //分页查询所有
    public Page&lt;SysUser&gt; findAll(Integer page, Integer size) &#123;
        PageRequest pageRequest = PageRequest.of(page - 1, size);
        return sysUserDao.findAll(pageRequest);
    &#125;
&#125;
</code></pre>
<ul>
<li>创建controller</li>
</ul>
<pre><code class="java">@RestController
@RequestMapping(&quot;/sysuser&quot;)
public class SysUserController &#123;

    @Autowired
    private SysUserService sysUserService;

    //查询全部
    @RequestMapping(&quot;findAll&quot;)
    public Result findAll()&#123;
        List&lt;SysUser&gt; sysUserList = sysUserService.findAll();
        return new Result(true, StatusCode.OK,&quot;ok&quot;,sysUserList);
    &#125;
    //根据id查询
    @RequestMapping(&quot;findById&quot;)
    public Result findById()&#123;
        SysUser sysUser = sysUserService.findById();
        return new Result(true, StatusCode.OK,&quot;ok&quot;,sysUser);
    &#125;
    //增加
    @RequestMapping(&quot;add&quot;)
    public Result add()&#123;
        sysUserService.add();
        return new Result(true, StatusCode.OK,&quot;ok&quot;);
    &#125;
    //修改
    @RequestMapping(&quot;modify&quot;)
    public Result modify()&#123;
        sysUserService.modify();
        return new Result(true, StatusCode.OK,&quot;ok&quot;);
    &#125;
    //删除
    @RequestMapping(&quot;remove&quot;)
    public Result remove()&#123;
        sysUserService.remove();
        return new Result(true, StatusCode.OK,&quot;ok&quot;);
    &#125;
    //分页查询所有
    @RequestMapping(&quot;findAllByPage&quot;)
    public Result findAllByPage(Integer page,Integer size)&#123;
        Page&lt;SysUser&gt; pageresult = sysUserService.findAll(page,size);
        return new Result(true, StatusCode.OK,&quot;ok&quot;,pageresult);
    &#125;
&#125;
</code></pre>
<h4 id="4-2-3、根据方法命名查询"><a href="#4-2-3、根据方法命名查询" class="headerlink" title="4.2.3、根据方法命名查询"></a>4.2.3、根据方法命名查询</h4><p>与SpringDataJPA类似</p>
<ul>
<li>controller</li>
</ul>
<pre><code class="java">//查询name中带有王的
@RequestMapping(&quot;findByNameLike&quot;)
public Result findByNameLike(Integer page,Integer size)&#123;
    Page&lt;SysUser&gt; pageresult = sysUserService.findByNameLike(page,size);
    return new Result(true, StatusCode.OK,&quot;ok&quot;,pageresult);
&#125;
</code></pre>
<ul>
<li>service</li>
</ul>
<pre><code class="java">public Page&lt;SysUser&gt; findByNameLike(Integer page, Integer size) &#123;
    PageRequest pageRequest = PageRequest.of(page - 1, size);
    return sysUserDao.findByNameLike(&quot;王&quot;,pageRequest);
&#125;
</code></pre>
<ul>
<li>dao</li>
</ul>
<pre><code class="java">public interface SysUserDao extends MongoRepository&lt;SysUser,String&gt; &#123;
    Page&lt;SysUser&gt; findByNameLike(String name, Pageable pageable);
&#125;
</code></pre>
<h4 id="4-2-4、使用MongoTemplate"><a href="#4-2-4、使用MongoTemplate" class="headerlink" title="4.2.4、使用MongoTemplate"></a>4.2.4、使用MongoTemplate</h4><p>首先需要注入<code>MongoTemplate</code></p>
<pre><code class="java">public class SysUserService &#123;

    @Autowired
    private MongoTemplate mongoTemplate;//注入操作mongo的模板对象
    
    //.......
&#125;
</code></pre>
<p>然后就可以通过MongoTemplate的API来操作Mongo了</p>
<ul>
<li>id为1的age的值增加1</li>
</ul>
<pre><code class="java">public void updateAge()&#123;
    Query query = new Query();
    query.addCriteria(Criteria.where(&quot;_id&quot;).is(&quot;1&quot;));
    Update update = new Update();
    update.inc(&quot;age&quot;,1);//让age的值自增1
    mongoTemplate.updateFirst(query,update,SysUser.class);
&#125;
</code></pre>
<ul>
<li>修改id为1的age和name字段</li>
</ul>
<pre><code class="java">public void update()&#123;
    Query query = new Query();
    query.addCriteria(Criteria.where(&quot;_id&quot;).is(&quot;1&quot;));
    Update update = new Update();
    //修改字段
    update.set(&quot;age&quot;,1);
    update.set(&quot;name&quot;,&quot;张撒&quot;);
    mongoTemplate.updateFirst(query,update,SysUser.class);
&#125;
</code></pre>
<h3 id="相关文档"><a href="#相关文档" class="headerlink" title="相关文档"></a>相关文档</h3><p><a target="_blank" rel="noopener" href="https://www.runoob.com/mongodb/mongodb-tutorial.html">https://www.runoob.com/mongodb/mongodb-tutorial.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/sinat_35821285/article/details/83511203">https://blog.csdn.net/sinat_35821285/article/details/83511203</a></p>

						</div>
						
						

				</div>
			</div>
		</div>
		<!-- 置顶按钮 -->
		<!-- 置顶 -->
<ul id="toTopBtn" class="layui-fixbar" style="right: -70px;">
    <a href="javascript:void(0)">
        <li class="layui-icon layui-fixbar-top" lay-type="top" style="display: list-item;">&#xe604;</li>
    </a>
</ul>
		<!-- 底部版权 -->
		<div class="qy-footer">
    <div class="font-Area">
        Copyright © 2018~<span id="currentYear">2022</span> <span class="layui-icon layui-icon-heart-fill footer-heart"></span> HeLiuFang All Rights Reserved 
    </div>
</div>
</body>
<script src="../../../../../js/jquery.min.js"></script>
<script src="../../../../../layui/layui.js"></script>
<!-- 鼠标点击特效 -->
<script src="../../../../../js/mouse.js"></script>
<!-- 代码高亮 -->
<script src="../../../../../lib/prism/prism.js"></script>
<!-- 公共js -->
<script>
    //点击搜索
    $("#searchBtn").click(function () {
        $("#searchShade").show()
        $("#searchLayer").addClass('layui-anim layui-anim-scaleSpring')
    })
    //关闭搜索弹框
    $("#closeBtn").click(function () {
        $("#searchShade").hide() 
    })
    //搜索本地文章标题 https://cloud.tencent.com/developer/article/1624646
    var searchFunc = function (path, search_id, content_id) {
        $.ajax({
            url: path,
            dataType: "json",
            success: function (datas) {
                //console.log('datas :>> ', datas);
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_url = data.url;
                        var index_title = -1;
                        var first_occur = -1;
                        if (data_title != '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                if (index_title < 0) {
                                    isMatch = false;
                                } else {
                                    data_title = data_title.replace(new RegExp(keyword, 'g'), '<span style="color:red">' + keyword + '</span>')
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    }
    searchFunc("/" + "search.json", 'searchTxt', 'searchResult');


    //随机背景线条 https://blog.csdn.net/qq526362801/article/details/108863458
    function DynamicLine() {
        function n(n, e, t) {
            return n.getAttribute(e) || t
        }

        function e(n) {
            return document.getElementsByTagName(n)
        }

        function t() {
            var t = e("script"),
                o = t.length,
                i = t[o - 1];
            return {
                l: o,
                z: n(i, "zIndex", -1),
                o: n(i, "opacity", .5),
                c: n(i, "color", "0,0,50"), //颜色rgb
                n: n(i, "count", 99)
            }
        }

        function o() {
            a = m.width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth,
                c = m.height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight
        }

        function i() {
            r.clearRect(0, 0, a, c);
            var n, e, t, o, m, l;
            s.forEach(function (i, x) {
                for (i.x += i.xa, i.y += i.ya, i.xa *= i.x > a || i.x < 0 ? -1 : 1, i.ya *= i.y > c || i.y < 0 ? -1 : 1, r.fillRect(
                    i.x - .5, i.y - .5, 1, 1), e = x + 1; e < u.length; e++) n = u[e],
                        null !== n.x && null !== n.y && (o = i.x - n.x, m = i.y - n.y,
                            l = o * o + m * m, l < n.max && (n === y && l >= n.max / 2 && (i.x -= .03 * o, i.y -= .03 * m),
                                t = (n.max - l) / n.max, r.beginPath(), r.lineWidth = t / 2, r.strokeStyle = "rgba(" + d.c + "," + (t + .2) +
                                ")", r.moveTo(i.x, i.y), r.lineTo(n.x, n.y), r.stroke()))
            }),
                x(i)
        }
        var a, c, u, m = document.createElement("canvas"),
            d = t(),
            l = "c_n" + d.l,
            r = m.getContext("2d"),
            x = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window
                .oRequestAnimationFrame || window.msRequestAnimationFrame ||
                function (n) {
                    window.setTimeout(n, 1e3 / 45)
                },
            w = Math.random,
            y = {
                x: null,
                y: null,
                max: 2e4
            };
        m.id = l, m.style.cssText = "position:fixed;top:0;left:0;z-index:" + d.z + ";opacity:" + d.o, e("body")[0].appendChild(
            m), o(), window.onresize = o,
            window.onmousemove = function (n) {
                n = n || window.event, y.x = n.clientX, y.y = n.clientY
            },
            window.onmouseout = function () {
                y.x = null, y.y = null
            };
        for (var s = [], f = 0; d.n > f; f++) {
            var h = w() * a,
                g = w() * c,
                v = 2 * w() - 1,
                p = 2 * w() - 1;
            s.push({
                x: h,
                y: g,
                xa: v,
                ya: p,
                max: 6e3
            })
        }
        u = s.concat([y]),
            setTimeout(function () {
                i()
            }, 100)
    }
    //随机背景线条
    DynamicLine()
    //更新页脚年份
    document.querySelector("#currentYear").innerText = new Date().getFullYear()


    //置顶  增加scrollTop的动画效果,使用定时器，将scrollTop的值每次减少50(减少六十分之一)，直到减少到0，则动画完毕
    $("#toTopBtn").click(function () {
        var oTop = $(window).scrollTop()
        var t = parseInt(oTop / 60) //每次六十分之一
        var time = setInterval(function () {
            console.log('toTopBtn...setInterval',$(window).scrollTop())
            $(window).scrollTop($(window).scrollTop() - t)
            if ($(window).scrollTop() === 0) {
                clearInterval(time);
            }
        }, 1);
    })
    $.event.add(window, "scroll", function () {
        //显示与隐藏置顶按钮   transition: all 0.5s;
        $("#toTopBtn").css('transform', $(window).scrollTop() > 0 ? 'translateX(-85px)' : 'translateX(85px)');
        $("#toTopBtn").css('transition', "all 0.5s");
    })
    //隐藏loading
    $("#loadingBox").hide(); 
</script>
<script>
	//注意：导航和进度条 依赖 element 模块，否则无法进行功能性操作
	var element = null
	layui.use(['element'], function () {
		element = layui.element;
	});
	
		$(function () {
			var elm = $('#toc-area');
			var startPos = $(elm).offset().top;
			//var totalTop = $(document).height();
			$.event.add(window, "scroll", function () {
				var totalTop = $(".markdown-body").height();
				var p = $(window).scrollTop()+$("#toc-area").height();
				//文章阅读进度条
				var percent = ((p / totalTop) * 100).toFixed(2)
				if (percent > 95) {
					percent = 100
				}
				if (percent == 0) {
					percent = 0
				}
				element.progress('demo', percent + "%");
				$("#progressTxt").text(percent)
				console.log('percent', percent)
				$("#progressNav").css("width", $(window).scrollTop() == 0? 0 : percent + "%")
				//固定文章目录
				//console.log('p', p+$("#toc-area").height(), "startPos", startPos+$("#toc-area").height(),"totalTop",totalTop)
				$(elm).css('position', ($(window).scrollTop() > startPos) ? 'fixed' : 'static');
				$(elm).css('top', ($(window).scrollTop() > startPos) ? '60px' : '');
				//文章目录随页面滚动
				$('#tocMain').scrollTop($('#tocMain .toc').height() * percent * 0.01);
			});
			//代码高亮
			$('pre code').each(function () {
				var codeType = $(this).attr("class")
				codeType = codeType == undefined || codeType == "" || codeType == null ? "plaintext" : codeType
				codeType = "language-" + codeType
				$(this).attr("class", codeType)
			})
			//代码复制以及显示代码语言
			$("pre").prepend('<div class="copy-to-clipboard-button"></div>');
		});
	
</script>

</html>